
# Creation of an objective function for the RNA folding problem


For a given ribonucleotide chain, the RNA folding problem consists in finding the native fold among the astronomically large number of possible conformations. The native fold being the one with the lowest Gibbs free energy, the objective function should be an estimator of this energy.




# Authors 
* Jinmei GAO , <sub>School project M2 GENIOMHE paris saclay - Structural Bioinformatics - Professor Guillaume Postic</sub>
![image](https://user-images.githubusercontent.com/91075082/212911968-8f96c123-a30d-4afe-9317-10727520eb41.png)




# Goals
I will implement 3 Python scripts to:

- train the objective function, using interatomic distance distributions that are computed from a dataset of known (10 RNA structures) (i.e., experimentally determined) 3D structures;
the 10 RNA structures are 10 pdb files which you can find in the pdb folder

- plot the scoring profiles, i.e. the score (or estimated Gibbs free energy) as a function of the interatomic distance;

- use the objective function to evaluate predicted structures from the RNA-Puzzles dataset.

# Calculate distance between two C3 atoms
## Euclidean distance
D(i,j) = $\sqrt{(Xi-Xj)^2+(Yi-Yj)^2+(Zi-Zj)^2}$

D < 21 are choosen

# Calculate scores (pseudo-energy) in each distance for each pair of nucleotides
1. observed probability/frequency

For each pair:
$f_obs = N(r)/N$

N(r) is the number of pair that has distance=r

N is the total number of distances

3. reference frequency

$f_ref = N(r)/N$
N(r) is the number of pair that has distance=r

N is the total number of distances

5. the score (pseudo-energy)

$âˆ’log( f_obs(r) / f_ref(r) )$

## Usage/Examples
First these packages are required


```javascript
conda install -c anaconda numpy 
or
pip install numpy


pip install pandas

conda install -c conda-forge matplotlib

```


## script1.py
The input of the first script will be some RNA structures (PDB files)

I used 10 RNA structures in the pdb directory as input to train

The output of the first script will be 10 files which contains the scores for 10 pairs in different distance.
in the output file, the column 1 is the distance and the column 2 is the corresponding pseudo-energy.

check how to use this script
```bash
  python script1.py --help
```
using the script by using the directory where keeps all the pdb files
```bash
  python script1.py -d pdb/
```
```

```
## script2.py
The input of the second script will be the 10 files that are generated by the first script

The output of the second script will be 10 graphs that is the plot of the 10 files

To run script2, run the following command

```bash
  python script2.py
```
```

```
## script3.py
The input of script3 is one RNA structru and the output is a estimated Gibbs free enrgy.

Script3 is used to calculate the estimated Gibbs free energy for one RNA structure.

A linear interpolation is used, here is the function:
$y(x) = y1+(x-x1)*(y2-y2)/(x2-x1)$

x is the distance of each pair of nuleotides
x1 and x2 are also the distances
for example,
For each pair: 
if 0<x<=1, x1 = 0, x2 = 1, y1 is the score in distance x1, y2 is the score in distance x2

if 1<x<1.5, x1 = 0, x2 = 1,...

if 1.5<=x<=2, x1 = 1, x2 = 2,...

...

Gibbs free energy = $sum_{y(x)}$

check how to use this script

```bash
  python script3.py --help
```
using the script by using a RNA structure as input (a pdb file)
```bash
  python script2.py -pdb 2lx1.pdb
```


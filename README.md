
# Creation of an objective function for the RNA folding problem


For a given ribonucleotide chain, the RNA folding problem consists in finding the native fold among the astronomically large number of possible conformations. The native fold being the one with the lowest Gibbs free energy, the objective function should be an estimator of this energy.




# Authors 
* Jinmei GAO , <sub>School project M2 GENIOMHE paris saclay - Structural Bioinformatics - Professor Guillaume Postic</sub>



# Goals
 3 Python scripts will be implemented


* Train the objective function, using interatomic distance distributions that are computed from a dataset of known (10 RNA structures) (i.e., experimentally determined) 3D structures;

the 10 RNA structures are 10 pdb files which you can find in the pdb folder

* Plot the scoring profiles, i.e. the score (or estimated Gibbs free energy) as a function of the interatomic distance

* Using linear interpolation to compute all the distance for a given structure


## Overall Constraint 

* Only C3' atoms are taken into account
 
* Only consider intrachain distances are considered
 
* Only consider residues separed by 3 position on the sequence

* Compute observed frequencies ( range of 0 to 20 Ångström of observing two residues i and j separared by a distance bin r


 ## Training script : Compute the interactomic distance from a given set of PDB files : 
* Calculate distance between two C3 atoms
 Euclidean distance
D(i,j) = $\sqrt{(Xi-Xj)^2+(Yi-Yj)^2+(Zi-Zj)^2}$

D < 21 are choosen

* Compute observed frequencies, range of 0 to 20 Ångström of observing two residues i and j separared by a distance bin r is calculated as follows :

$$ f_{i,j} ^{OBS}(r) = { N_{i,j}(r) \over N_{i,j} } $$

 Where $N_{i,j}(r)$ is the count of i and j within the distance bin r and $N_{i,j}$ is the count of i and j for all distance bins 


* Compute reference frequency , different residue types are indistinct X                    

 $$ f_{X,X} ^{REF}(r) = { N_{X,X}(r) \over N_{X,X}} $$


- use the objective function to evaluate predicted structures from the RNA-Puzzles dataset.
* Compute log-ratio of the two frequency (score of pseudo energy)

$$ u_{i,j}(r) = { -log \left( f _{i,j} ^{OBS}(r) \over f_{i,j} ^{REF}(r) \right) } $$


Training script should therefore generate 10 files of 21 lines. Maximum scoring value will be arbitrarily set to 10 


## Testing script : Evaluate predicted structures : 

It will compute all the distances for a given structure using the same treshold as the training script. For each distance, a scoring value will be computed using a linear interpolation as follow :

$$ Linear Interpolation(Y) = { y1 + (x - x1) \left (y2 - y1 \over x2 - x1 \right) } $$



## Clone the repository :

```bash
git clone https://github.com/GAOJinmei/Estimation-of-Gibbs-free-energy-for-RNA_Folfing.git 
```

## Usage/Examples
First these packages are required


```javascript
conda install -c anaconda numpy 
or
pip install numpy


pip install pandas

conda install -c conda-forge matplotlib

```


## script1.py
The input of the first script will be some RNA structures (PDB files)

I used 10 RNA structures in the pdb directory as input to train

The output of the first script will be 10 files which contains the scores for 10 pairs in different distance.
in the output file, the column 1 is the distance and the column 2 is the corresponding pseudo-energy.

check how to use this script
```bash
  python script1.py --help
```
using the script by using the directory where keeps all the pdb files
```bash
  python script1.py -d pdb/
```
```

```
## script2.py
The input of the second script will be the 10 files that are generated by the first script

The output of the second script will be 10 graphs that is the plot of the 10 files

To run script2, run the following command

```bash
  python script2.py
```
```

```
## script3.py
The input of script3 is one RNA structru and the output is a estimated Gibbs free enrgy.

Script3 is used to calculate the estimated Gibbs free energy for one RNA structure.

A linear interpolation is used, here is the function:
$y(x) = y1+(x-x1)*(y2-y2)/(x2-x1)$

x is the distance of each pair of nuleotides
x1 and x2 are also the distances
for example,
For each pair: 
if 0<x<=1, x1 = 0, x2 = 1, y1 is the score in distance x1, y2 is the score in distance x2

if 1<x<1.5, x1 = 0, x2 = 1,...

if 1.5<=x<=2, x1 = 1, x2 = 2,...

...

Gibbs free energy = $sum_{y(x)}$

check how to use this script

```bash
  python script3.py --help
```
using the script by using a RNA structure as input (a pdb file)
```bash
  python script2.py -pdb 2lx1.pdb
```

